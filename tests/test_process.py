import pytest

from hseling_api_nauchpop.process import process_topic, process_rb


test_data_1 = [
    ({}, []),
    ({"text3.txt": "Мария Луиса Беатрис Теран родилась в 1918 году в Росарио. "
                   "Её отец был буфетчиком местного клуба спортивной гребли,"
                   " и Мария впервые начала заниматься теннисом на кортах этого клуба, "
                   "где также занималась плаванием и греблей. "
                   "К 14 годам она представляла провинцию Санта-Фе на национальных теннисных соревнованиях,"
                   " была рулевой мужской гребной сборной клуба «Альберди» и участвовала в "
                   "традиционном заплыве через Парану. Девочка демонстрировала упорство и способности к"
                   " игре и привлекла к себе внимание тренера сборной Аргентины в Кубке Дэвиса Сандерса,"
                   " который начал с ней заниматься[1]."}, ["Язык и культура"]),
    ({"text3.txt": b"\xd0\x9c\xd0\xb0\xd1\x80\xd0\xb8\xd1\x8f "
                   b"\xd0\x9b\xd1\x83\xd0\xb8\xd1\x81\xd0\xb0 "
                   b"\xd0\x91\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x81 "
                   b"\xd0\xa2\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbd "
                   b"\xd1\x80\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c "
                   b"\xd0\xb2 1918 \xd0\xb3\xd0\xbe\xd0\xb4\xd1\x83 \xd0\xb2 "
                   b"\xd0\xa0\xd0\xbe\xd1\x81\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbe. "
                   b"\xd0\x95\xd1\x91 \xd0\xbe\xd1\x82\xd0\xb5\xd1\x86 "
                   b"\xd0\xb1\xd1\x8b\xd0\xbb "
                   b"\xd0\xb1\xd1\x83\xd1\x84\xd0\xb5\xd1\x82\xd1\x87\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc "
                   b"\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe "
                   b"\xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0 "
                   b"\xd1\x81\xd0\xbf\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbb\xd0\xb8, "
                   b"\xd0\xb8 \xd0\x9c\xd0\xb0\xd1\x80\xd0\xb8\xd1\x8f "
                   b"\xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 "
                   b"\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f "
                   b"\xd1\x82\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd1\x81\xd0\xbe\xd0\xbc "
                   b"\xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x80\xd1\x82\xd0\xb0\xd1\x85 "
                   b"\xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0, "
                   b"\xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c "
                   b"\xd0\xbf\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc "
                   b"\xd0\xb8 \xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbb\xd0\xb5\xd0\xb9. "
                   b"\xd0\x9a 14 \xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 "
                   b"\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xbb\xd0\xb0 "
                   b"\xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x86\xd0\xb8\xd1\x8e "
                   b"\xd0\xa1\xd0\xb0\xd0\xbd\xd1\x82\xd0\xb0-\xd0\xa4\xd0\xb5 \xd0\xbd\xd0\xb0 "
                   b"\xd0\xbd\xd0\xb0\xd1\x86\xd0\xb8\xd0\xbe\xd0\xbd\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 "
                   b"\xd1\x82\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 "
                   b"\xd1\x81\xd0\xbe\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb2\xd0"
                   b"\xb0\xd0\xbd\xd0\xb8\xd1\x8f\xd1\x85, "
                   b"\xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd1\x80\xd1\x83\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb9 "
                   b"\xd0\xbc\xd1\x83\xd0\xb6\xd1\x81\xd0\xba\xd0\xbe\xd0\xb9 "
                   b"\xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd1\x81\xd0\xb1\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0 "
                   b"\xc2\xab\xd0\x90\xd0\xbb\xd1\x8c\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb4\xd0\xb8\xc2\xbb "
                   b"\xd0\xb8 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd0\xb2 \xd1\x82\xd1\x80\xd0\xb0\xd0\xb4\xd0\xb8\xd1\x86"
                   b"\xd0\xb8\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc "
                   b"\xd0\xb7\xd0\xb0\xd0\xbf\xd0\xbb\xd1\x8b\xd0\xb2\xd0\xb5 "
                   b"\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\x9f\xd0\xb0\xd1\x80\xd0\xb0\xd0\xbd\xd1\x83. "
                   b"\xd0\x94\xd0\xb5\xd0\xb2\xd0\xbe\xd1\x87\xd0\xba\xd0\xb0 "
                   b"\xd0\xb4\xd0\xb5\xd0\xbc\xd0\xbe\xd0\xbd\xd1\x81\xd1\x82\xd1"
                   b"\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd1\x83\xd0\xbf\xd0\xbe\xd1\x80\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb8 "
                   b"\xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 "
                   b"\xd0\xba \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xb8 "
                   b"\xd0\xbf\xd1\x80\xd0\xb8\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xba\xd0\xbb\xd0\xb0 "
                   b"\xd0\xba \xd1\x81\xd0\xb5\xd0\xb1\xd0\xb5 "
                   b"\xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 "
                   b"\xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0 "
                   b"\xd1\x81\xd0\xb1\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\x90\xd1\x80\xd0\xb3\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd0\xbd\xd1\x8b "
                   b"\xd0\xb2 \xd0\x9a\xd1\x83\xd0\xb1\xd0\xba\xd0\xb5 "
                   b"\xd0\x94\xd1\x8d\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb0 "
                   b"\xd0\xa1\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb5\xd1\x80\xd1\x81\xd0\xb0, "
                   b"\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 "
                   b"\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb \xd1\x81 \xd0\xbd\xd0\xb5\xd0\xb9 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0"
                   b"\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f[1]."}, ["Язык и культура"]),
]

test_data_2 = [
    ({}, []),
    ({"text3.txt": "Мария Луиса Беатрис Теран родилась в 1918 году в Росарио. "
                   "Её отец был буфетчиком местного клуба спортивной гребли,"
                   " и Мария впервые начала заниматься теннисом на кортах этого клуба, "
                   "где также занималась плаванием и греблей. К 14 годам она представляла "
                   "провинцию Санта-Фе на национальных теннисных соревнованиях, "
                   "была рулевой мужской гребной сборной клуба «Альберди» и участвовала"
                   " в традиционном заплыве через Парану. Девочка демонстрировала упорство"
                   " и способности к игре и привлекла к себе внимание тренера сборной Аргентины "
                   "в Кубке Дэвиса Сандерса, который начал с ней заниматься[1]."},
     ["Количество предложений в тексте: 4 "
     "Количество слов в тексте: 83 "
     "Средняя длина предложений: 20.75 "
     "Количество символов в тексте: 501 "
     "Средняя длина слова: 6.04 "
     "Средняя длина предложений в символах: 125.25 "
     "Количество слогов в тексте: 196 "
     "Среднее количество слогов в слове: 2.36 "
     "Среднее количеcтво слогов в предложении: 49.0 "
     "Количество сложных слов в тексте: 13 "
     "Процент сложных слов в тексте 15.66 "
     "Russian Flesh reading Ease = 36.84 "
     "Russian Flesh-Kincaid Grade = 14.61 "
     "Russian SMOG = 13.43 Russian CLI = 17.75 "
     "Russian DCH = 7.4 "
     "Russian Gunning Fog = 14.56 "
     "NOUNS: 32.53 VERBS: 1.2 "
     "PREPOSITIONS: 13.25 CONJS: 7.23 "
     "ADJECTIVES: 14.46 "
     "Разговорные слова: 241.0 "
     "Общие слова: 3012.0 "
     "Грубые слова: 241.0 "
     "Приставки СИ: 0.0"]
     ),
    ({"text3.txt": b"\xd0\x9c\xd0\xb0\xd1\x80\xd0\xb8\xd1\x8f "
                   b"\xd0\x9b\xd1\x83\xd0\xb8\xd1\x81\xd0\xb0 "
                   b"\xd0\x91\xd0\xb5\xd0\xb0\xd1\x82\xd1\x80\xd0\xb8\xd1\x81 "
                   b"\xd0\xa2\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbd "
                   b"\xd1\x80\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c "
                   b"\xd0\xb2 1918 \xd0\xb3\xd0\xbe\xd0\xb4\xd1\x83 \xd0\xb2 "
                   b"\xd0\xa0\xd0\xbe\xd1\x81\xd0\xb0\xd1\x80\xd0\xb8\xd0\xbe. "
                   b"\xd0\x95\xd1\x91 \xd0\xbe\xd1\x82\xd0\xb5\xd1\x86 "
                   b"\xd0\xb1\xd1\x8b\xd0\xbb "
                   b"\xd0\xb1\xd1\x83\xd1\x84\xd0\xb5\xd1\x82\xd1\x87\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc "
                   b"\xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe "
                   b"\xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0 "
                   b"\xd1\x81\xd0\xbf\xd0\xbe\xd1\x80\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbb\xd0\xb8, "
                   b"\xd0\xb8 \xd0\x9c\xd0\xb0\xd1\x80\xd0\xb8\xd1\x8f "
                   b"\xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb5 "
                   b"\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f "
                   b"\xd1\x82\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd1\x81\xd0\xbe\xd0\xbc "
                   b"\xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x80\xd1\x82\xd0\xb0\xd1\x85 "
                   b"\xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0, "
                   b"\xd0\xb3\xd0\xb4\xd0\xb5 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd0\xb0\xd1\x81\xd1\x8c "
                   b"\xd0\xbf\xd0\xbb\xd0\xb0\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5\xd0\xbc "
                   b"\xd0\xb8 \xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbb\xd0\xb5\xd0\xb9. "
                   b"\xd0\x9a 14 \xd0\xb3\xd0\xbe\xd0\xb4\xd0\xb0\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 "
                   b"\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xbb\xd0\xb0 "
                   b"\xd0\xbf\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xbd\xd1\x86\xd0\xb8\xd1\x8e "
                   b"\xd0\xa1\xd0\xb0\xd0\xbd\xd1\x82\xd0\xb0-\xd0\xa4\xd0\xb5 \xd0\xbd\xd0\xb0 "
                   b"\xd0\xbd\xd0\xb0\xd1\x86\xd0\xb8\xd0\xbe\xd0\xbd\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 "
                   b"\xd1\x82\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb8\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 "
                   b"\xd1\x81\xd0\xbe\xd1\x80\xd0\xb5\xd0\xb2\xd0\xbd"
                   b"\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f\xd1\x85, "
                   b"\xd0\xb1\xd1\x8b\xd0\xbb\xd0\xb0 \xd1\x80\xd1\x83\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xbe\xd0\xb9 "
                   b"\xd0\xbc\xd1\x83\xd0\xb6\xd1\x81\xd0\xba\xd0\xbe\xd0\xb9 "
                   b"\xd0\xb3\xd1\x80\xd0\xb5\xd0\xb1\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd1\x81\xd0\xb1\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\xba\xd0\xbb\xd1\x83\xd0\xb1\xd0\xb0 "
                   b"\xc2\xab\xd0\x90\xd0\xbb\xd1\x8c\xd0\xb1\xd0\xb5\xd1\x80\xd0\xb4\xd0\xb8\xc2\xbb "
                   b"\xd0\xb8 \xd1\x83\xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd0\xb2 \xd1\x82\xd1\x80\xd0\xb0\xd0\xb4\xd0"
                   b"\xb8\xd1\x86\xd0\xb8\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc "
                   b"\xd0\xb7\xd0\xb0\xd0\xbf\xd0\xbb\xd1\x8b\xd0\xb2\xd0\xb5 "
                   b"\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\x9f\xd0\xb0\xd1\x80\xd0\xb0\xd0\xbd\xd1\x83. "
                   b"\xd0\x94\xd0\xb5\xd0\xb2\xd0\xbe\xd1\x87\xd0\xba\xd0\xb0 "
                   b"\xd0\xb4\xd0\xb5\xd0\xbc\xd0\xbe\xd0\xbd\xd1\x81\xd1"
                   b"\x82\xd1\x80\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb0 "
                   b"\xd1\x83\xd0\xbf\xd0\xbe\xd1\x80\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe \xd0\xb8 "
                   b"\xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 "
                   b"\xd0\xba \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xb8 "
                   b"\xd0\xbf\xd1\x80\xd0\xb8\xd0\xb2\xd0\xbb\xd0\xb5\xd0\xba\xd0\xbb\xd0\xb0 "
                   b"\xd0\xba \xd1\x81\xd0\xb5\xd0\xb1\xd0\xb5 "
                   b"\xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 "
                   b"\xd1\x82\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x80\xd0\xb0 "
                   b"\xd1\x81\xd0\xb1\xd0\xbe\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb9 "
                   b"\xd0\x90\xd1\x80\xd0\xb3\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb8\xd0\xbd\xd1\x8b "
                   b"\xd0\xb2 \xd0\x9a\xd1\x83\xd0\xb1\xd0\xba\xd0\xb5 "
                   b"\xd0\x94\xd1\x8d\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb0 "
                   b"\xd0\xa1\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb5\xd1\x80\xd1\x81\xd0\xb0, "
                   b"\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 "
                   b"\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb \xd1\x81 \xd0\xbd\xd0\xb5\xd0\xb9 "
                   b"\xd0\xb7\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xbc"
                   b"\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f[1]."},
     ["Количество предложений в тексте: 4 "
     "Количество слов в тексте: 83 "
     "Средняя длина предложений: 20.75 "
     "Количество символов в тексте: 501 "
     "Средняя длина слова: 6.04 "
     "Средняя длина предложений в символах: 125.25 "
     "Количество слогов в тексте: 196 "
     "Среднее количество слогов в слове: 2.36 "
     "Среднее количеcтво слогов в предложении: 49.0 "
     "Количество сложных слов в тексте: 13 "
     "Процент сложных слов в тексте 15.66 "
     "Russian Flesh reading Ease = 36.84 "
     "Russian Flesh-Kincaid Grade = 14.61 "
     "Russian SMOG = 13.43 Russian CLI = 17.75 "
     "Russian DCH = 7.4 "
     "Russian Gunning Fog = 14.56 "
     "NOUNS: 32.53 VERBS: 1.2 "
     "PREPOSITIONS: 13.25 CONJS: 7.23 "
     "ADJECTIVES: 14.46 "
     "Разговорные слова: 241.0 "
     "Общие слова: 3012.0 "
     "Грубые слова: 241.0 "
     "Приставки СИ: 0.0"]
     )
]


@pytest.mark.parametrize("input_data, expected_result", test_data_1)
def test_process_topic(input_data, expected_result):
    processed_data = [contents for _, contents in process_topic(input_data)]
    assert processed_data == expected_result


@pytest.mark.parametrize("input_data, expected_result", test_data_2)
def test_process_rb(input_data, expected_result):
    processed_data = [contents for _, contents in process_rb(input_data)]
    assert processed_data == expected_result



